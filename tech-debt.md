# Tech Debt

## Cloudflare tunnel secret in Terraform state

The Cloudflare tunnel secret is generated by `random_id` in Terraform and stored in state (S3). If state is compromised, the tunnel token is exposed. Consider managing the tunnel lifecycle outside Terraform (e.g. via dashboard or CLI) and only using Terraform for DNS and tunnel config.

## Switch to HTTP webhook entrypoint with Cloudflare tunnel

The bot currently runs via the Discord gateway (`bot.ts`) in Docker. The preferred production setup is to use the HTTP webhook entrypoint (`server.ts`) behind a Cloudflare tunnel, which avoids maintaining a persistent WebSocket connection. This requires moving `kye.dev` DNS to Cloudflare (or at least delegating the subdomain), which isn't feasible right now since the zone is on Route53 and Cloudflare requires full zone activation. The tunnel infrastructure (terraform, compose tunnel service) is already in place â€” it just needs working DNS. Revisit when migrating `kye.dev` to Cloudflare becomes an option.
